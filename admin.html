<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

  <!-- Barra de navegación -->
  <div class="bg-blue-600 text-white p-4 flex space-x-4">
    <button class="tab-btn font-semibold" data-tab="pacientes">Pacientes</button>
    <button class="tab-btn font-semibold" data-tab="resumen">Resumen</button>
    <button class="tab-btn font-semibold" data-tab="sedes">Sedes</button>
  </div>

  <!-- Contenido de pestañas -->
  <div class="p-6">

    <!-- Pestaña Pacientes -->
    <div id="tab-pacientes" class="tab-content">
      <h2 class="text-xl font-bold mb-4">Módulo Pacientes</h2>
      <p class="text-gray-600">Aquí luego moveremos lo que ahora está en tu <code>index.html</code>.</p>
    </div>

    <!-- Pestaña Resumen -->
    <div id="tab-resumen" class="tab-content hidden">
      <h2 class="text-xl font-bold mb-4">Resumen</h2>
      <p class="text-gray-600">Aquí luego moveremos lo de <code>resumen.html</code>.</p>
    </div>

    <!-- Pestaña Sedes -->
    <div id="tab-sedes" class="tab-content hidden">
      <h2 class="text-xl font-bold mb-4">Gestión de Sedes</h2>

      <!-- Formulario agregar sede -->
      <form id="formSede" class="mb-4">
        <input type="text" id="sedeNombre" placeholder="Nombre de sede" class="border p-2 rounded w-64" required>
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Agregar</button>
      </form>

      <!-- Lista de sedes -->
      <ul id="listaSedes" class="space-y-2"></ul>
    </div>

  </div>

  <!-- Scripts -->
  <script type="module">
    import { getDatabase, ref, push, set, onValue, remove } 
      from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";
    import { app } from "./firebaseConfig.js"; // asegúrate que este archivo ya existe

    const db = getDatabase(app);

    // -------------------
    // CAMBIO DE PESTAÑAS
    // -------------------
    const tabBtns = document.querySelectorAll(".tab-btn");
    const tabContents = document.querySelectorAll(".tab-content");

    tabBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        const target = btn.dataset.tab;
        tabContents.forEach(c => c.classList.add("hidden"));
        document.getElementById("tab-" + target).classList.remove("hidden");
      });
    });

    // -------------------
    // MÓDULO SEDES
    // -------------------
    const formSede = document.getElementById("formSede");
    const sedeNombre = document.getElementById("sedeNombre");
    const listaSedes = document.getElementById("listaSedes");

    // Agregar sede
    formSede.addEventListener("submit", (e) => {
      e.preventDefault();
      const nuevaSedeRef = push(ref(db, "sedes"));
      set(nuevaSedeRef, { nombre: sedeNombre.value });
      sedeNombre.value = "";
    });

    // Listar sedes en tiempo real
    onValue(ref(db, "sedes"), (snapshot) => {
      listaSedes.innerHTML = "";
      snapshot.forEach((child) => {
        const key = child.key;
        const { nombre } = child.val();

        const li = document.createElement("li");
        li.className = "flex justify-between items-center bg-gray-100 p-2 rounded";

        li.innerHTML = `
          <span>${nombre}</span>
          <button class="bg-red-500 text-white px-2 py-1 rounded" data-id="${key}">Eliminar</button>
        `;

        // Botón eliminar
        li.querySelector("button").addEventListener("click", () => {
          remove(ref(db, "sedes/" + key));
        });

        listaSedes.appendChild(li);
      });
    });
  </script>
</body>
</html>
